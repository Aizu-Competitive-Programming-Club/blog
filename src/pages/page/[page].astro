---
type Props = { page: string };

export async function getStaticPaths() {
	// Keep generating these pages so old /page/n/ links don't 404,
	// but treat them as deprecated in favor of /?p=n.
	// Generate a reasonable upper bound (will redirect even if out of range).
	return Array.from({ length: 200 }, (_, i) => ({ params: { page: String(i + 1) } }));
}

const params = Astro.params as Props;
const page = Math.max(1, Number(params.page ?? '1') || 1);

const base = import.meta.env.BASE_URL;
const basePath = base.endsWith('/') ? base : `${base}/`;
const canonical = page === 1 ? `${basePath}` : `${basePath}?p=${page}`;
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1" />
		<link rel="canonical" href={canonical} />
		<meta http-equiv="refresh" content={`0; url=${canonical}`} />
	</head>
	<body>
		<p>Redirecting to <a href={canonical}>{canonical}</a>â€¦</p>
	</body>
</html>
